{"ast":null,"code":"import { elevenLabsService } from './elevenLabsService';\nclass VoiceAnalysisService {\n  constructor() {\n    this.fillerWords = ['um', 'uh', 'like', 'you know', 'so', 'well', 'actually', 'basically', 'literally'];\n  }\n  async analyzeVoice(audioBlob, transcript) {\n    try {\n      let finalTranscript = transcript;\n      let confidence = 75;\n\n      // Use ElevenLabs for transcription if we have audio\n      try {\n        const elevenLabsTranscript = await elevenLabsService.speechToText(audioBlob);\n        if (elevenLabsTranscript && elevenLabsTranscript.trim().length > 0) {\n          finalTranscript = elevenLabsTranscript;\n          confidence = 90; // Higher confidence with ElevenLabs transcription\n        }\n      } catch (error) {\n        console.log('ElevenLabs transcription failed, using basic transcript:', error);\n      }\n\n      // Basic analysis from transcript\n      const words = finalTranscript.toLowerCase().split(/\\s+/);\n      const fillerWordCount = this.countFillerWords(words);\n      const speakingRate = this.calculateSpeakingRate(words, 30); // Assume 30 seconds for now\n\n      // Analyze sentiment\n      const sentiment = this.analyzeSentiment(finalTranscript);\n      return {\n        fillerWords: fillerWordCount,\n        speakingRate: Math.round(speakingRate),\n        volume: this.estimateVolume(audioBlob),\n        clarity: this.estimateClarity(finalTranscript),\n        transcript: finalTranscript,\n        sentiment,\n        confidence\n      };\n    } catch (error) {\n      console.error('Voice analysis error:', error);\n      // Return fallback analysis\n      return this.getFallbackAnalysis(transcript);\n    }\n  }\n  countFillerWords(words) {\n    return words.filter(word => this.fillerWords.includes(word.replace(/[^\\w]/g, ''))).length;\n  }\n  calculateSpeakingRate(words, durationSeconds) {\n    const durationMinutes = durationSeconds / 60;\n    return words.length / durationMinutes;\n  }\n  estimateVolume(audioBlob) {\n    // This is a simplified volume estimation\n    // In a real implementation, you'd analyze the audio data\n    const size = audioBlob.size;\n    if (size > 100000) return 85; // Large file = loud\n    if (size > 50000) return 75; // Medium file = medium\n    return 65; // Small file = quiet\n  }\n  estimateClarity(transcript) {\n    // Simple clarity estimation based on transcript quality\n    const words = transcript.split(/\\s+/);\n    const clearWords = words.filter(word => word.length > 1 && /^[a-zA-Z]+$/.test(word));\n    return Math.round(clearWords.length / words.length * 100);\n  }\n  analyzeSentiment(transcript) {\n    const positiveWords = ['good', 'great', 'excellent', 'amazing', 'wonderful', 'confident', 'excited'];\n    const negativeWords = ['bad', 'terrible', 'awful', 'nervous', 'worried', 'scared', 'difficult'];\n    const words = transcript.toLowerCase().split(/\\s+/);\n    const positiveCount = words.filter(word => positiveWords.includes(word)).length;\n    const negativeCount = words.filter(word => negativeWords.includes(word)).length;\n    if (positiveCount > negativeCount) return 'positive';\n    if (negativeCount > positiveCount) return 'negative';\n    return 'neutral';\n  }\n  getFallbackAnalysis(transcript) {\n    const words = transcript.split(/\\s+/);\n    return {\n      fillerWords: this.countFillerWords(words),\n      speakingRate: 140,\n      volume: 75,\n      clarity: 80,\n      transcript,\n      sentiment: 'neutral',\n      confidence: 60\n    };\n  }\n\n  // Generate AI voice for interview questions\n  async generateQuestionVoice(question) {\n    try {\n      return await elevenLabsService.generateQuestionAudio(question);\n    } catch (error) {\n      console.error('Failed to generate AI voice:', error);\n      return null;\n    }\n  }\n}\nexport const voiceAnalysisService = new VoiceAnalysisService();","map":{"version":3,"names":["elevenLabsService","VoiceAnalysisService","constructor","fillerWords","analyzeVoice","audioBlob","transcript","finalTranscript","confidence","elevenLabsTranscript","speechToText","trim","length","error","console","log","words","toLowerCase","split","fillerWordCount","countFillerWords","speakingRate","calculateSpeakingRate","sentiment","analyzeSentiment","Math","round","volume","estimateVolume","clarity","estimateClarity","getFallbackAnalysis","filter","word","includes","replace","durationSeconds","durationMinutes","size","clearWords","test","positiveWords","negativeWords","positiveCount","negativeCount","generateQuestionVoice","question","generateQuestionAudio","voiceAnalysisService"],"sources":["/Users/irisxu/Documents/DubHacks2025/dubhacksmain/src/services/voiceAnalysisService.ts"],"sourcesContent":["import { elevenLabsService } from './elevenLabsService';\n\ninterface VoiceAnalysisResult {\n  fillerWords: number;\n  speakingRate: number;\n  volume: number;\n  clarity: number;\n  transcript: string;\n  sentiment: string;\n  confidence: number;\n}\n\nclass VoiceAnalysisService {\n  private fillerWords = ['um', 'uh', 'like', 'you know', 'so', 'well', 'actually', 'basically', 'literally'];\n\n  async analyzeVoice(audioBlob: Blob, transcript: string): Promise<VoiceAnalysisResult> {\n    try {\n      let finalTranscript = transcript;\n      let confidence = 75;\n      \n      // Use ElevenLabs for transcription if we have audio\n      try {\n        const elevenLabsTranscript = await elevenLabsService.speechToText(audioBlob);\n        if (elevenLabsTranscript && elevenLabsTranscript.trim().length > 0) {\n          finalTranscript = elevenLabsTranscript;\n          confidence = 90; // Higher confidence with ElevenLabs transcription\n        }\n      } catch (error) {\n        console.log('ElevenLabs transcription failed, using basic transcript:', error);\n      }\n      \n      // Basic analysis from transcript\n      const words = finalTranscript.toLowerCase().split(/\\s+/);\n      const fillerWordCount = this.countFillerWords(words);\n      const speakingRate = this.calculateSpeakingRate(words, 30); // Assume 30 seconds for now\n      \n      // Analyze sentiment\n      const sentiment = this.analyzeSentiment(finalTranscript);\n\n      return {\n        fillerWords: fillerWordCount,\n        speakingRate: Math.round(speakingRate),\n        volume: this.estimateVolume(audioBlob),\n        clarity: this.estimateClarity(finalTranscript),\n        transcript: finalTranscript,\n        sentiment,\n        confidence\n      };\n    } catch (error) {\n      console.error('Voice analysis error:', error);\n      // Return fallback analysis\n      return this.getFallbackAnalysis(transcript);\n    }\n  }\n\n  private countFillerWords(words: string[]): number {\n    return words.filter(word => \n      this.fillerWords.includes(word.replace(/[^\\w]/g, ''))\n    ).length;\n  }\n\n  private calculateSpeakingRate(words: string[], durationSeconds: number): number {\n    const durationMinutes = durationSeconds / 60;\n    return words.length / durationMinutes;\n  }\n\n  private estimateVolume(audioBlob: Blob): number {\n    // This is a simplified volume estimation\n    // In a real implementation, you'd analyze the audio data\n    const size = audioBlob.size;\n    if (size > 100000) return 85; // Large file = loud\n    if (size > 50000) return 75;  // Medium file = medium\n    return 65; // Small file = quiet\n  }\n\n  private estimateClarity(transcript: string): number {\n    // Simple clarity estimation based on transcript quality\n    const words = transcript.split(/\\s+/);\n    const clearWords = words.filter(word => word.length > 1 && /^[a-zA-Z]+$/.test(word));\n    return Math.round((clearWords.length / words.length) * 100);\n  }\n\n  private analyzeSentiment(transcript: string): string {\n    const positiveWords = ['good', 'great', 'excellent', 'amazing', 'wonderful', 'confident', 'excited'];\n    const negativeWords = ['bad', 'terrible', 'awful', 'nervous', 'worried', 'scared', 'difficult'];\n    \n    const words = transcript.toLowerCase().split(/\\s+/);\n    const positiveCount = words.filter(word => positiveWords.includes(word)).length;\n    const negativeCount = words.filter(word => negativeWords.includes(word)).length;\n    \n    if (positiveCount > negativeCount) return 'positive';\n    if (negativeCount > positiveCount) return 'negative';\n    return 'neutral';\n  }\n\n  private getFallbackAnalysis(transcript: string): VoiceAnalysisResult {\n    const words = transcript.split(/\\s+/);\n    return {\n      fillerWords: this.countFillerWords(words),\n      speakingRate: 140,\n      volume: 75,\n      clarity: 80,\n      transcript,\n      sentiment: 'neutral',\n      confidence: 60\n    };\n  }\n\n  // Generate AI voice for interview questions\n  async generateQuestionVoice(question: string): Promise<HTMLAudioElement | null> {\n    try {\n      return await elevenLabsService.generateQuestionAudio(question);\n    } catch (error) {\n      console.error('Failed to generate AI voice:', error);\n      return null;\n    }\n  }\n}\n\nexport const voiceAnalysisService = new VoiceAnalysisService();\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}